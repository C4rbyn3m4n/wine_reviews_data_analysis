---
title: "Exploring and Analyizing Wine Enthusiast Reviews"
output: html_notebook
---

## Introduction

- Load the `tidyverse, ggplot, and rtweet` packages
```{r, message=FALSE, warning=FALSE}
library(tidyverse)
library(ggplot2)
library(rtweet)
library(readr)
```


This data set was scraped from WineEnthusiast, a website that reviews and rates many differet types of wines.  

- This dataset includes information of of 130,000 wine reviews with 10 different data fields. 
  

```{r}
#read preprocessed data
wines <- read.csv(file = '../data/processed_data/wines.csv')
```

```{r}
#set seed value to birthday of Ricardo Rodriguez, American wrestler and ring announcer
set.seed(19630217)

#set percentage to test with for simplicity
percentage <- 10
wine_sample<- sample_n(wines, percentage/100*nrow(wines))
```

EDA (correlation priceXpoints, with ```DataExplorer``` library? using (this)[https://datascienceplus.com/blazing-fast-eda-in-r-with-dataexplorer/])
```{r}
wines %>% 
  ggplot() +
    geom_point(mapping = (aes(x = points, y = price)), na.rm = T)
```

```{r}
wines %>%
    summarize(avg_price = mean(price, na.rm=TRUE), 
              sd_price = sd(price, na.rm=TRUE),
              lowest_price = min(price, na.rm=TRUE),
              highest_price = max(price,na.rm=TRUE))
```

```{r}
wines %>%
    summarize(avg_points = mean(points, na.rm=TRUE), 
              sd_points = sd(points, na.rm=TRUE),
              lowest_points = min(points, na.rm=TRUE),
              highest_points = max(points,na.rm=TRUE))
```

Select the provinces based on points  and Select the best province for wine based on the average points of the sample size. 

#find the average number of points across the 1,000 samples
```{r}
wine_per_province <- wine %>% 
  select(province, points) %>% 
  summarise(points = mean(points))
wine_per_province
```


#Find the best province for wine using the average points across the 1,000 samples
#drop the descriptions or just select price? set points to max(points)
```{r}
best_province <- wine_sample %>% 
  group_by(province, points) %>% 
  filter(points > 88.669)
best_province  
```


Rating distribution

```{r}

```

Best wine, by variety
```{r}
#wine_best_variety <- 
wines %>% 
  group_by(variety) %>% 
  summarise(mean_points = mean(points)) %>% 
  arrange(desc(mean_points)) 
  
```

```{r}
user_price <- readline(prompt = "How much are you willing to spend on a bottle?")
user_price <- as.integer(user_price)

wines %>% 
  filter(price <= user_price) %>% 
  arrange(desc(points)) %>% 
  select(title, price, points)
```


##Conclusion
