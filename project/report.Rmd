---
title: "Exploring and Analyizing Wine Enthusiast Reviews"
output: html_notebook
---

# Prerequisites

Load required packages
```{r, message=FALSE, warning=FALSE}
library(tidyverse)
library(ggplot2)
library(rtweet)
library(readr)
```

# Dataset

Import processed data, which can be found [here](https://github.com/C4rbyn3m4n/wine_reviews_data_analysis/blob/master/data/processed_data/preprocessing.rmd).

```{r}
#read preprocessed data
wines <- read.csv(file = '../data/processed_data/wines.csv')
```

Get sample of dataset
```{r}
#set seed value to birthday of Ricardo Rodriguez, American wrestler and ring announcer and Dr. Reinaldo (Rei) Sanchez-Arias
set.seed(19630217)

#set percentage to test with for simplicity
percentage <- 5
wine_sample<- sample_n(wines, percentage/100*nrow(wines))
```

### Split Taster data into different table

```{r}
tasters <- wines %>%
  select(taster_name, taster_twitter_handle) %>% unique()
tasters
```

Drop `taster_twitter_handle` in wines dataframe

```{r}
wines <- wines %>%
  select(-taster_twitter_handle)
head(wines)
```

### Add Rating Classification

Add following classification to wine dataset as found on the [website](https://www.winemag.com/2010/04/09/you-asked-how-is-a-wines-score-determined/):

|Category  | Rating  | Description                                            |
|----------|---------|--------------------------------------------------------|
|Classic   |	98-100 | The pinnacle of quality.                               |
|Superb    |	94-97	 | A great achievement.                                   |
|Excellent |	90-93	 | Highly recommended.                                    |
|Very Good |  87-89	 | Often good value; well recommended.                    |
|Good	     |  83-86	 | Suitable for everyday consumption; often good value.   |
|Acceptable|	80-82	 | Can be employed in casual, less-critical circumstances |

```{r}
# function to add rating
rating_category <- function(points){
  if(points>=98){
    return("Classic")
  }
  else if (points>=94){
    return("Superb")
  }
  else if(points>=90){
    return("Excellent")
  }
  else if(points>=87){
    return("Very Good")
  }
  else if(points>=83){
    return("Good")
  }
  else{
    return("Acceptable")
  }
}

wines<- wines %>%
  rowwise() %>%
  mutate(rating_category = rating_category(points))
head(wines)
```

# Explore the Data

EDA (correlation priceXpoints, with ```DataExplorer``` library? using (this)[https://datascienceplus.com/blazing-fast-eda-in-r-with-dataexplorer/])
```{r}
wines %>% 
  ggplot() +
    geom_point(mapping = (aes(x = points, y = price)), na.rm = T)
```

```{r}
wines %>%
    summarize(avg_price = mean(price, na.rm=TRUE), 
              sd_price = sd(price, na.rm=TRUE),
              lowest_price = min(price, na.rm=TRUE),
              highest_price = max(price,na.rm=TRUE))
```

```{r}
wines %>%
    summarize(avg_points = mean(points, na.rm=TRUE), 
              sd_points = sd(points, na.rm=TRUE),
              lowest_points = min(points, na.rm=TRUE),
              highest_points = max(points,na.rm=TRUE))
```

Select the provinces based on points  and Select the best province for wine based on the average points of the sample size. 

#find the average number of points across the 1,000 samples
```{r}
wine_per_province <- wine %>% 
  select(province, points) %>% 
  summarise(points = mean(points))
wine_per_province
```


#Find the best province for wine using the average points across the 1,000 samples
#drop the descriptions or just select price? set points to max(points)
```{r}
best_province <- wine_sample %>% 
  group_by(province, points) %>% 
  filter(points > 88.669)
best_province  
```


Rating distribution

```{r}

```

Best wine, by variety
```{r}
#wine_best_variety <- 
wines %>% 
  group_by(variety) %>% 
  summarise(mean_points = mean(points)) %>% 
  arrange(desc(mean_points)) 
  
```

```{r}
user_price <- readline(prompt = "How much are you willing to spend on a bottle?")
user_price <- as.integer(user_price)

wines %>% 
  filter(price <= user_price) %>% 
  arrange(desc(points)) %>% 
  select(title, price, points)
```


##Conclusion
